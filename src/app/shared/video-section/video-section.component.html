<section class="video-section" id="videos-section">
  <div class="video-container">
    <!-- Section Header -->
    <div class="section-header" data-aos="fade-up">
      <div class="section-badge">
        <i class="fas fa-play-circle"></i>
        <span>مقاطع الفيديو</span>
      </div>
      <h2 class="section-title">شاهد خدماتنا المتميزة</h2>
      <p class="section-subtitle">
        تعرف على مرافقنا الطبية المتطورة وفريقنا الطبي المتخصص من خلال مقاطع الفيديو التفاعلية
      </p>
    </div>

    <div class="video-content-grid">
      <!-- Main Video Player -->
      <div class="main-video-section" data-aos="fade-right">
        <div class="video-player-card">
          <div class="video-player-container">
            <video
              #mainVideo
              class="main-video"
              [poster]="selectedVideo.thumbnail"
              (play)="onVideoCanPlay()"
              (pause)="onVideoPause()"
              (ended)="onVideoEnded()"
              (error)="onVideoError($event)"
              preload="metadata"
              playsinline
              [autoplay]="playlistSettings.autoPlay"
              [muted]="playerState.isMuted"
              [loop]="playlistSettings.repeat">
              <source [src]="videos[selectedVideoIndex].url" type="video/mp4">
              <p>المتصفح الخاص بك لا يدعم تشغيل الفيديو</p>
            </video>

            <!-- Custom Video Controls -->
            <div class="video-controls-overlay" [class.hidden]="isVideoPlaying && !playerState.isPaused">
              <div class="video-overlay-content">
                <button class="play-button" (click)="playVideo()" aria-label="تشغيل الفيديو" *ngIf="!isVideoPlaying || playerState.isPaused">
                  <div class="play-icon">
                    <i class="fas fa-play"></i>
                  </div>
                  <div class="play-ripple"></div>
                </button>
                <button class="play-button" (click)="pauseVideo()" aria-label="إيقاف الفيديو مؤقتًا" *ngIf="isVideoPlaying && !playerState.isPaused">
                  <div class="play-icon">
                    <i class="fas fa-pause"></i>
                  </div>
                  <div class="play-ripple"></div>
                </button>

                <div class="video-meta">
                  <div class="video-duration-badge">
                    <i class="fas fa-clock"></i>
                    <span>{{ selectedVideo.duration }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Video Controls Bar -->
            <div class="video-controls-bar">
              <button class="control-btn" (click)="playVideo()" *ngIf="!isVideoPlaying || playerState.isPaused" title="تشغيل">
                <i class="fas fa-play"></i>
              </button>
              <button class="control-btn" (click)="pauseVideo()" *ngIf="isVideoPlaying && !playerState.isPaused" title="إيقاف مؤقت">
                <i class="fas fa-pause"></i>
              </button>
              <button class="control-btn" (click)="stopVideo()" title="إيقاف">
                <i class="fas fa-stop"></i>
              </button>
              <button class="control-btn" (click)="replayVideo()" title="إعادة تشغيل">
                <i class="fas fa-redo"></i>
              </button>
              <button class="control-btn" (click)="toggleMute()" title="{{ playerState.isMuted ? 'تفعيل الصوت' : 'كتم الصوت' }}">
                <i class="fas" [ngClass]="playerState.isMuted ? 'fa-volume-mute' : 'fa-volume-up'"></i>
              </button>
              <button class="control-btn" (click)="toggleFullScreen()" title="{{ playerState.isFullScreen ? 'الخروج من الشاشة الكاملة' : 'شاشة كاملة' }}">
                <i class="fas" [ngClass]="playerState.isFullScreen ? 'fa-compress' : 'fa-expand'"></i>
              </button>
              <div class="video-progress-bar">
                <div class="progress" [style.width.%]="videoProgress"></div>
              </div>
            </div>

            <!-- Video Quality Indicator -->
            <div class="video-quality-badge">
              <span>HD</span>
            </div>
          </div>

          <!-- Video Information -->
          <div class="video-info-section">
            <h3 class="video-title">{{ selectedVideo.title }}</h3>
            <p class="video-description">{{ selectedVideo.description }}</p>
          </div>
        </div>
      </div>

      <!-- Video Playlist -->
      <div class="video-playlist-section" data-aos="fade-left">
        <div class="playlist-card">
          <div class="playlist-header">
            <div class="playlist-title-section">
              <h4 class="playlist-title">
                <i class="fas fa-list-ul"></i>
                قائمة الفيديوهات
              </h4>
              <span class="playlist-count">{{ videos.length }} فيديو</span>
            </div>

            <!-- Playlist Controls -->
            <div class="playlist-controls">
              <button class="control-btn" title="تشغيل تلقائي" [class.active]="autoPlayEnabled" (click)="toggleAutoPlay()">
                <i class="fas fa-sync-alt"></i>
              </button>
              <button class="control-btn" title="تكرار الفيديو" [class.active]="playlistSettings.repeat" (click)="toggleRepeat()">
                <i class="fas fa-retweet"></i>
              </button>
            </div>
          </div>

          <!-- Video List -->
          <div class="video-playlist" #videoPlaylist>
            <div
              *ngFor="let video of videos; let i = index"
              class="video-item"
              [class.active]="selectedVideoIndex === i"
              (click)="selectVideo(i)"
              [attr.data-index]="i">
              <div class="video-thumbnail-container">
                <img [src]="video.thumbnail" [alt]="video.title" class="video-thumbnail" loading="lazy">
                <div class="thumbnail-overlay">
                  <div class="play-indicator">
                    <i class="fas fa-play" *ngIf="selectedVideoIndex !== i"></i>
                    <i class="fas fa-pause" *ngIf="selectedVideoIndex === i && isVideoPlaying"></i>
                  </div>
                </div>
                <div class="video-duration">{{ video.duration }}</div>
              </div>
              <div class="video-item-content">
                <h5 class="video-item-title">{{ video.title }}</h5>
                <p class="video-item-description">{{ video.shortDescription }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
